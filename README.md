# Quantitative Risk Engine (MOEX)

![Python](https://img.shields.io/badge/Python-3.9%2B-blue)
![License](https://img.shields.io/badge/License-MIT-green)
![Status](https://img.shields.io/badge/Status-Research-orange)

**–§—Ä–µ–π–º–≤–æ—Ä–∫ —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è –∏ –æ—Ü–µ–Ω–∫–∏ —Ä—ã–Ω–æ—á–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤ –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∞–∫—Ç–∏–≤–æ–≤ (MOEX).**

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è: –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ GARCH-–∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –¥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º —á–µ—Ä–µ–∑ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –ì–∞–º–∏–ª—å—Ç–æ–Ω–∞ ‚Äî –Ø–∫–æ–±–∏ ‚Äî –ë–µ–ª–ª–º–∞–Ω–∞ (HJB) –∏ –æ—Ü–µ–Ω–∫–∏ —Ö–≤–æ—Å—Ç–æ–≤—ã—Ö —Ä–∏—Å–∫–æ–≤ –º–µ—Ç–æ–¥–æ–º –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ.

---

## üìä –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

*   **ETL & Data Pipeline**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ—Ç–∏—Ä–æ–≤–æ–∫ —á–µ—Ä–µ–∑ MOEX ISS API, –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –¥–µ—Ç–µ–∫—Ü–∏—è —Å–ø–ª–∏—Ç–æ–≤ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤.
*   **Volatility Modeling**: –û—Ü–µ–Ω–∫–∞ —Ä—ã–Ω–æ—á–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ —Å –ø–æ–º–æ—â—å—é **GARCH(1,1)**. –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ—Å—Ç–∏, –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ç—è–∂–µ–ª—ã—Ö —Ö–≤–æ—Å—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
*   **Portfolio Optimization (HJB)**: –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–∑–∞–¥–∞—á–∞ –ú–µ—Ä—Ç–æ–Ω–∞) –¥–ª—è –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ CRRA-–ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤.
*   **Monte Carlo Simulation**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 10,000+ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —ç–≤–æ–ª—é—Ü–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:
    *   –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ (GBM).
    *   *(–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)* –°–∫–∞—á–∫–æ–æ–±—Ä–∞–∑–Ω–∞—è –¥–∏—Ñ—Ñ—É–∑–∏—è –ú–µ—Ä—Ç–æ–Ω–∞ (MJD) –∏ –ø—Ä–æ—Ü–µ—Å—Å—ã –õ–µ–≤–∏.
*   **Risk Metrics**: –†–∞—Å—á–µ—Ç VaR (95/99), CVaR (Expected Shortfall), Maximum Drawdown –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–∑–æ—Ä–µ–Ω–∏—è.

---

##  –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞

### 1. –î–∏–Ω–∞–º–∏–∫–∞ –∞–∫—Ç–∏–≤–æ–≤
–≠–≤–æ–ª—é—Ü–∏—è —Ü–µ–Ω —Ä–∏—Å–∫–æ–≤—ã—Ö –∞–∫—Ç–∏–≤–æ–≤ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç—Å—è —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–º –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º (SDE):

$$ \frac{dS_t}{S_t} = \mu dt + \sigma dW_t $$

–ì–¥–µ $W_t$ ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ. –î–ª—è —É—á–µ—Ç–∞ "–∂–∏—Ä–Ω—ã—Ö —Ö–≤–æ—Å—Ç–æ–≤" (fat tails) –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã $\sigma$ –∫–∞–ª–∏–±—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ GARCH(1,1):

$$ \sigma^2_t = \omega + \alpha \varepsilon^2_{t-1} + \beta \sigma^2_{t-1} $$

### 2. –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (HJB)
–ó–∞–¥–∞—á–∞ –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞ ‚Äî –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è –æ–∂–∏–¥–∞–µ–º–æ–π –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–≥–æ –±–æ–≥–∞—Ç—Å—Ç–≤–∞ $U(X_T) = \frac{X_T^{1-\gamma}}{1-\gamma}$ (CRRA). –§—É–Ω–∫—Ü–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏ $V(t, x)$ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —É—Ä–∞–≤–Ω–µ–Ω–∏—é HJB:

$$ \frac{\partial V}{\partial t} + \sup_{w} \left\{ (rx + w(\mu - r)x) \frac{\partial V}{\partial x} + \frac{1}{2} w^2 \sigma^2 x^2 \frac{\partial^2 V}{\partial x^2} \right\} = 0 $$

–†–µ—à–µ–Ω–∏–µ –¥–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –¥–æ–ª—é —Ä–∏—Å–∫–æ–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∞:

$$ w^* = \frac{\mu - r}{\gamma \sigma^2} $$

---

##  –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

–ü—Ä–æ–µ–∫—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –≤ –≤–∏–¥–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –Ω–æ—É—Ç–±—É–∫–æ–≤ (Jupyter Notebooks):

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| `data_loader.ipynb` | –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å MOEX, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Parquet, –æ—á–∏—Å—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤. |
| `filtration.ipynb` | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞–∫—Ç–∏–≤–æ–≤ –ø–æ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤—É –¥–∞–Ω–Ω—ã—Ö. |
| `GARCH.ipynb` | –≠–∫–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏, —Ñ–∏—Ç—Ç–∏–Ω–≥ GARCH-–º–æ–¥–µ–ª–µ–π. |
| `HJB_strategy.ipynb` | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏ —Ä–µ—à–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏. |
| `VaR_backtest.ipynb` | –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ –∏ —Å–∏–º—É–ª—è—Ü–∏—è –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ, —Ä–∞—Å—á–µ—Ç —Ä–∏—Å–∫–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫. |
| `results_analitics.ipynb` | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ "–≤–µ–µ—Ä–æ–≤" —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π. |

---

##  Quick Start

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
*   Python 3.8+
*   –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏: `numpy`, `pandas`, `scipy`, `arch`, `matplotlib`, `seaborn`

### –ó–∞–ø—É—Å–∫
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–æ—É—Ç–±—É–∫–∏ –≤ –ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ:
1.  **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `data_loader.ipynb` –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–∞ –∫–æ—Ç–∏—Ä–æ–≤–æ–∫.
2.  **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `GARCH.ipynb` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏.
3.  **–°–∏–º—É–ª—è—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `VaR_backtest.ipynb` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –¥–≤–∏–∂–∫–∞ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ.

---

##  Disclaimer

–î–∞–Ω–Ω—ã–π –∫–æ–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö. –ú–æ–¥–µ–ª–∏ –∏ —Å–∏–º—É–ª—è—Ü–∏–∏ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π. –ê–≤—Ç–æ—Ä –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –ª—é–±—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è, –ø—Ä–∏–Ω—è—Ç—ã–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è.

---

**Author:** Egor Galkin  
**Focus:** Quantitative Finance, Market Risk, Derivatives Pricing
